import{A as o,Aa as C,B as f,Ba as ge,C as S,Ca as pt,D as u,Da as Ie,E as d,Ea as M,F as $e,G as V,H as Ge,I as l,J as _,K as A,L as Ke,M as te,N as D,O as R,P as H,Q as G,R as Ze,S as j,T as Ee,U as ie,V as Je,W as Qe,X as O,Y as I,Z as Xe,_ as ne,a as Ne,aa as Ye,b as Ve,ba as et,c as Ae,ca as tt,d as De,da as it,e as P,ea as nt,f as Re,fa as T,g as He,ga as y,h as je,ha as N,i as Ue,ia as re,j as Be,ja as oe,k as $,ka as ae,l as Y,la as le,m as k,ma as se,n as v,na as me,o as h,oa as ce,p as ze,pa as pe,q as qe,qa as de,r as L,ra as rt,s as a,sa as ot,t as g,ta as ue,u as x,ua as at,v as ee,va as lt,w as p,wa as st,x as We,xa as mt,y as m,ya as K,z as r,za as ct}from"./chunk-R7UIGUDC.js";var w=class n{constructor(t){this.http=t;localStorage.getItem(this.sessionKey)&&this.fetchMe().catch(()=>this.logout())}api=mt();sessionKey="sessionToken";currentUserSubject=new Ae(null);currentUser$=this.currentUserSubject.asObservable();async register(t,e,i){let s=await P(this.http.post(`${this.api}/auth/register`,{name:t,email:e,password:i}));return s?.token&&localStorage.setItem(this.sessionKey,s.token),s?.user||await this.fetchMe()}async login(t,e){let i=await P(this.http.post(`${this.api}/auth/login`,{email:t,password:e}));if(!i?.token)throw new Error("Credenciais inv\xE1lidas");return localStorage.setItem(this.sessionKey,i.token),i?.user||await this.fetchMe()}logout(){localStorage.removeItem(this.sessionKey),this.currentUserSubject.next(null)}getToken(){return localStorage.getItem(this.sessionKey)}async fetchMe(){let t=await P(this.http.get(`${this.api}/auth/me`));return this.currentUserSubject.next(t),t}isAdmin(){let t=this.currentUserSubject.getValue();return!!t&&t.role==="admin"}static \u0275fac=function(e){return new(e||n)(k(tt))};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};var fe=class n{constructor(t,e){this.auth=t;this.router=e}intercept(t,e){let i=this.auth.getToken(),s=i?t.clone({setHeaders:{Authorization:`Bearer ${i}`}}):t,c=e.handle(s);return(t.method==="GET"?c.pipe(Be(1)):c).pipe(je(E=>(console.error("HTTP error",{url:t.url,status:E?.status,message:E?.message}),E?.status===401&&(this.auth.logout(),this.router.navigate(["/login"],{queryParams:{reason:"auth",next:this.router.url.split("#")[1]||"/"}})),De(()=>E))))}static \u0275fac=function(e){return new(e||n)(k(w),k(C))};static \u0275prov=$({token:n,factory:n.\u0275fac})};function dt(n,t){if(n&1&&(r(0,"option",16),l(1),o()),n&2){let e=t.$implicit;m("value",e),a(),_(e)}}function ut(n,t){n&1&&(r(0,"div",17)(1,"div",18)(2,"span",19),l(3,"Carregando..."),o()()())}function gt(n,t){if(n&1&&f(0,"img",30),n&2){let e=d().$implicit;m("src",e.images[0],L)("alt",e.title)}}function ft(n,t){if(n&1){let e=S();r(0,"div",20),u("click",function(){let s=v(e).$implicit,c=d();return h(c.view(s))}),r(1,"div",21),p(2,gt,1,2,"img",22),r(3,"div",23)(4,"h6",24),l(5),o(),r(6,"p",25),l(7),o(),r(8,"div",26),l(9),j(10,"number"),o()(),r(11,"div",27)(12,"button",28),u("click",function(s){let c=v(e).$implicit,b=d();return s.stopPropagation(),h(b.toggleFav(c.id))}),l(13),o(),r(14,"span",29),l(15),o()()()()}if(n&2){let e=t.$implicit,i=d();a(2),m("ngIf",e.images==null?null:e.images.length),a(3),_(e.title),a(2),Ke("",e.city," - ",e.state),a(2),A("R$ ",ie(10,7,e.price,"1.0-2")),a(4),_(i.isFav(e.id)?"Remover":"Favoritar"),a(2),A("",e.views," visitas")}}function vt(n,t){n&1&&(r(0,"div",31),l(1,"Nenhum an\xFAncio encontrado"),o())}function ht(n,t){if(n&1&&(r(0,"option",16),l(1),o()),n&2){let e=t.$implicit;m("value",e),a(),_(e)}}function _t(n,t){if(n&1){let e=S();r(0,"div",32)(1,"div",33),l(2),o(),r(3,"div",34)(4,"div",35)(5,"span",36),l(6,"Itens"),o(),r(7,"select",37),H("ngModelChange",function(s){v(e);let c=d();return R(c.size,s)||(c.size=s),h(s)}),u("change",function(){v(e);let s=d();return h(s.setSize(s.size))}),p(8,ht,2,2,"option",5),o()(),r(9,"div",35)(10,"input",38),H("ngModelChange",function(s){v(e);let c=d();return R(c.goto,s)||(c.goto=s),h(s)}),o(),r(11,"button",39),u("click",function(){v(e);let s=d();return h(s.goToPageInput())}),l(12,"Ir"),o()(),r(13,"div",40)(14,"button",41),u("click",function(){v(e);let s=d();return h(s.prevPage())}),l(15,"Anterior"),o(),r(16,"button",41),u("click",function(){v(e);let s=d();return h(s.nextPage())}),l(17,"Pr\xF3xima"),o()()()()}if(n&2){let e=d();a(2),te("P\xE1gina ",e.page+1," de ",e.totalPages," \u2014 Total ",e.total),a(5),D("ngModel",e.size),a(),m("ngForOf",e.sizes),a(2),m("max",e.totalPages),D("ngModel",e.goto),a(4),m("disabled",e.page===0),a(2),m("disabled",e.page+1>=e.totalPages)}}var Z=class n{constructor(t,e,i){this.listingService=t;this.route=e;this.router=i}listings=[];categories=[];q="";category="";city="";favoritesOnly=!1;loading=!1;total=0;page=0;size=12;sizes=[12,24,48];goto=1;get totalPages(){return Math.max(1,Math.ceil(this.total/this.size))}ngOnInit(){this.categories=this.listingService.categories(),He([this.route.paramMap,this.route.queryParamMap,this.route.data]).subscribe(([t,e,i])=>{let s=t.get("slug");if(s){let c=this.categories.find(b=>this.toSlug(b)===s);this.category=c||"",this.page=0}else this.category="";this.q=e.get("q")||"",this.favoritesOnly=!!i.favoritesOnly,this.refresh()})}refresh(){this.loading=!0,this.listingService.search(this.q,this.category||void 0,this.city||void 0,this.favoritesOnly,this.page,this.size).subscribe({next:t=>{this.listings=t.items,this.total=t.total,this.loading=!1},error:t=>{this.loading=!1}})}applyFilters(){this.page=0,this.refresh()}view(t){this.router.navigate(["/item",t.id],{state:{listing:t}})}toggleFav(t){this.listingService.toggleFavorite(t),this.refresh()}isFav(t){return this.listingService.isFavorite(t)}prevPage(){this.page>0&&(this.page--,this.refresh())}nextPage(){this.page+1<this.totalPages&&(this.page++,this.refresh())}goToPage(t){t>=0&&t<this.totalPages&&(this.page=t,this.refresh())}setSize(t){this.size=t,this.page=0,this.refresh()}goToPageInput(){let t=(this.goto||1)-1;t>=0&&t<this.totalPages&&(this.page=t,this.refresh())}toSlug(t){return t.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}+","gu"),"").replace(/\s+/g,"-")}static \u0275fac=function(e){return new(e||n)(g(M),g(K),g(C))};static \u0275cmp=x({type:n,selectors:[["ng-component"]],standalone:!1,decls:18,vars:7,consts:[[1,"container","mb-3"],[1,"row","g-2"],[1,"col-md-4"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6"],["placeholder","Cidade",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-2","d-grid"],[1,"btn","btn-primary",3,"click"],["class","text-center py-3",4,"ngIf"],[1,"container"],[1,"row","g-4"],["class","col-sm-6 col-md-4 col-lg-3",3,"click",4,"ngFor","ngForOf"],["class","text-center text-muted py-5",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[3,"value"],[1,"text-center","py-3"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"col-sm-6","col-md-4","col-lg-3",3,"click"],[1,"card","h-100","shadow-sm"],["class","card-img-top",3,"src","alt",4,"ngIf"],[1,"card-body"],[1,"card-title","text-truncate"],[1,"card-text","small","text-muted","mb-1"],[1,"fw-bold"],[1,"card-footer","bg-white","border-0","d-flex","justify-content-between"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"text-muted","small"],[1,"card-img-top",3,"src","alt"],[1,"text-center","text-muted","py-5"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"small","text-muted"],[1,"d-flex","gap-2"],[1,"input-group","input-group-sm",2,"width","180px"],[1,"input-group-text"],[1,"form-select",3,"ngModelChange","change","ngModel"],["type","number","min","1","placeholder","P\xE1gina",1,"form-control",3,"ngModelChange","max","ngModel"],[1,"btn","btn-outline-secondary",3,"click"],[1,"btn-group"],[1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),H("ngModelChange",function(c){return R(i.category,c)||(i.category=c),c}),r(4,"option",4),l(5,"Todas categorias"),o(),p(6,dt,2,2,"option",5),o()(),r(7,"div",6)(8,"input",7),H("ngModelChange",function(c){return R(i.city,c)||(i.city=c),c}),o()(),r(9,"div",8)(10,"button",9),u("click",function(){return i.applyFilters()}),l(11,"Filtrar"),o()()()(),p(12,ut,4,0,"div",10),r(13,"div",11)(14,"div",12),p(15,ft,16,10,"div",13)(16,vt,2,0,"div",14),o(),p(17,_t,18,9,"div",15),o()),e&2&&(a(3),D("ngModel",i.category),a(3),m("ngForOf",i.categories),a(2),D("ngModel",i.city),a(4),m("ngIf",i.loading),a(3),m("ngForOf",i.listings),a(),m("ngIf",!(i.listings!=null&&i.listings.length)),a(),m("ngIf",i.total>0))},dependencies:[O,I,pe,de,T,le,ce,N,ot,rt,oe,ne],styles:[".filters[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding:1rem}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem;padding:1rem}.card[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:8px;overflow:hidden;position:relative;cursor:pointer;background:#fff}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:140px;object-fit:cover}.info[_ngcontent-%COMP%]{padding:.5rem .75rem}.title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem}.price[_ngcontent-%COMP%]{color:#0c7;margin-bottom:.25rem}.meta[_ngcontent-%COMP%]{color:#666;font-size:.85rem}.fav[_ngcontent-%COMP%]{position:absolute;right:.5rem;top:.5rem;background:#fff;border:1px solid #ddd;border-radius:999px;width:32px;height:32px}"]})};function bt(n,t){n&1&&(r(0,"div",31),l(1,"Informe um t\xEDtulo v\xE1lido"),o())}function yt(n,t){n&1&&(r(0,"div",31),l(1,"Informe um pre\xE7o v\xE1lido"),o())}function Ct(n,t){n&1&&(r(0,"div",31),l(1,"Descreva o an\xFAncio"),o())}function xt(n,t){if(n&1&&(r(0,"option",32),l(1),o()),n&2){let e=t.$implicit;m("value",e),a(),_(e)}}function St(n,t){n&1&&(r(0,"div",31),l(1,"Selecione a categoria"),o())}function wt(n,t){if(n&1&&(r(0,"option",32),l(1),o()),n&2){let e=t.$implicit;m("value",e.sigla),a(),_(e.nome)}}function Et(n,t){n&1&&(r(0,"div",31),l(1,"Selecione o estado"),o())}function It(n,t){if(n&1&&(r(0,"option",32),l(1),o()),n&2){let e=t.$implicit;m("value",e.nome),a(),_(e.nome)}}function Mt(n,t){n&1&&(r(0,"div",31),l(1,"Selecione a cidade"),o())}function Ft(n,t){if(n&1){let e=S();r(0,"div",33),f(1,"img",34),r(2,"button",35),u("click",function(){let s=v(e).index,c=d();return h(c.removeImage(s))}),l(3,"Remover"),o()()}if(n&2){let e=t.$implicit;a(),m("src",e,L)}}var _e=class n{constructor(t,e,i,s){this.fb=t;this.listingService=e;this.auth=i;this.router=s;this.categories=this.listingService.categories(),this.form=this.fb.group({title:["",[y.required,y.minLength(5)]],description:["",[y.required,y.minLength(10)]],price:[0,[y.required,y.min(0)]],category:["",y.required],state:["",y.required],city:["",y.required],contactPhone:[""]}),this.listingService.getStates().subscribe(c=>{this.states=c}),this.form.get("state").valueChanges.subscribe(c=>{let b=this.states.find(E=>E.sigla===c);this.cities=[],this.form.get("city").setValue(""),b&&this.listingService.getCitiesByStateId(b.id).subscribe(E=>{this.cities=E})})}categories=[];images=[];states=[];cities=[];form;async onSubmit(){if(this.form.invalid)return;let t=await P(this.auth.currentUser$);if(!t)return;let e=await P(this.listingService.create(Ve(Ne({},this.form.value),{images:this.images,ownerId:t.id})));this.router.navigate(["/item",e.id])}async onFilesSelected(t){let e=t.target.files;if(!e||!e.length)return;let i=Array.from(e).map(c=>this.readFileAsDataURL(c)),s=await Promise.all(i);this.images=[...this.images,...s]}readFileAsDataURL(t){return new Promise((e,i)=>{let s=new FileReader;s.onload=()=>e(s.result),s.onerror=()=>i(s.error),s.readAsDataURL(t)})}removeImage(t){this.images.splice(t,1)}static \u0275fac=function(e){return new(e||n)(g(ue),g(M),g(w),g(C))};static \u0275cmp=x({type:n,selectors:[["ng-component"]],standalone:!1,decls:49,vars:25,consts:[[1,"listing-form","container","my-4"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"card","shadow-sm"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-md-8"],["formControlName","title","placeholder","T\xEDtulo",1,"form-control"],["class","invalid-feedback",4,"ngIf"],[1,"col-md-4"],["formControlName","price","type","number","placeholder","Pre\xE7o",1,"form-control"],[1,"col-12"],["formControlName","description","placeholder","Descri\xE7\xE3o","rows","4",1,"form-control"],[1,"col-md-6"],["formControlName","category",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3"],["formControlName","state",1,"form-select"],["formControlName","city",1,"form-select",3,"disabled"],["formControlName","contactPhone","placeholder","Telefone para contato (opcional)",1,"form-control"],[1,"images"],[1,"form-label"],["type","file","multiple","",1,"form-control",3,"change"],[1,"preview","mt-2"],["class","img",4,"ngFor","ngForOf"],[1,"col-12","text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"invalid-feedback"],[3,"value"],[1,"img"],[1,"img-thumbnail",3,"src"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"]],template:function(e,i){if(e&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),l(6,"Anunciar"),o()(),r(7,"div",6)(8,"form",7),u("ngSubmit",function(){return i.onSubmit()}),r(9,"div",8)(10,"div",9),f(11,"input",10),p(12,bt,2,0,"div",11),o(),r(13,"div",12),f(14,"input",13),p(15,yt,2,0,"div",11),o(),r(16,"div",14),f(17,"textarea",15),p(18,Ct,2,0,"div",11),o(),r(19,"div",16)(20,"select",17)(21,"option",18),l(22,"Categoria"),o(),p(23,xt,2,2,"option",19),o(),p(24,St,2,0,"div",11),o(),r(25,"div",20)(26,"select",21)(27,"option",18),l(28,"Estado"),o(),p(29,wt,2,2,"option",19),o(),p(30,Et,2,0,"div",11),o(),r(31,"div",20)(32,"select",22)(33,"option",18),l(34,"Cidade"),o(),p(35,It,2,2,"option",19),o(),p(36,Mt,2,0,"div",11),o(),r(37,"div",16),f(38,"input",23),o(),r(39,"div",14)(40,"div",24)(41,"label",25),l(42,"Imagens"),o(),r(43,"input",26),u("change",function(c){return i.onFilesSelected(c)}),o(),r(44,"div",27),p(45,Ft,4,1,"div",28),o()()(),r(46,"div",29)(47,"button",30),l(48,"Publicar"),o()()()()()()()()()),e&2){let s,c,b,E,B,Pe,z,Le,q,ke,W,Oe,Te;a(8),m("formGroup",i.form),a(3),V("is-invalid",((s=i.form.get("title"))==null?null:s.invalid)&&(((s=i.form.get("title"))==null?null:s.dirty)||((s=i.form.get("title"))==null?null:s.touched))),a(),m("ngIf",(c=i.form.get("title"))==null?null:c.errors),a(2),V("is-invalid",((b=i.form.get("price"))==null?null:b.invalid)&&(((b=i.form.get("price"))==null?null:b.dirty)||((b=i.form.get("price"))==null?null:b.touched))),a(),m("ngIf",(E=i.form.get("price"))==null?null:E.errors),a(2),V("is-invalid",((B=i.form.get("description"))==null?null:B.invalid)&&(((B=i.form.get("description"))==null?null:B.dirty)||((B=i.form.get("description"))==null?null:B.touched))),a(),m("ngIf",(Pe=i.form.get("description"))==null?null:Pe.errors),a(2),V("is-invalid",((z=i.form.get("category"))==null?null:z.invalid)&&(((z=i.form.get("category"))==null?null:z.dirty)||((z=i.form.get("category"))==null?null:z.touched))),a(3),m("ngForOf",i.categories),a(),m("ngIf",(Le=i.form.get("category"))==null?null:Le.errors),a(2),V("is-invalid",((q=i.form.get("state"))==null?null:q.invalid)&&(((q=i.form.get("state"))==null?null:q.dirty)||((q=i.form.get("state"))==null?null:q.touched))),a(3),m("ngForOf",i.states),a(),m("ngIf",(ke=i.form.get("state"))==null?null:ke.errors),a(2),V("is-invalid",((W=i.form.get("city"))==null?null:W.invalid)&&(((W=i.form.get("city"))==null?null:W.dirty)||((W=i.form.get("city"))==null?null:W.touched))),m("disabled",!i.states.length||!((Oe=i.form.get("state"))!=null&&Oe.value)),a(3),m("ngForOf",i.cities),a(),m("ngIf",(Te=i.form.get("city"))==null?null:Te.errors),a(9),m("ngForOf",i.images),a(2),m("disabled",i.form.invalid)}},dependencies:[O,I,ae,pe,de,T,le,ce,N,re,se,me],styles:[".images[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:.5rem}.images[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{position:relative}.images[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:120px;object-fit:cover;border-radius:.5rem}.images[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;right:.25rem;top:.25rem}"]})};var Fe=()=>["/"];function Pt(n,t){if(n&1&&(r(0,"div",1)(1,"div",2)(2,"span"),l(3),o(),r(4,"a",3),l(5,"Voltar"),o()()()),n&2){let e=d();a(3),_(e.listingDetailError),a(),m("routerLink",G(2,Fe))}}function Lt(n,t){if(n&1){let e=S();r(0,"img",20),u("click",function(){let s=v(e).index,c=d(3);return h(c.selectImage(s))}),o()}if(n&2){let e=t.$implicit,i=t.index,s=d(3);Ge("rounded border "+(s.selectedImage===i?"border-primary":"border-light")),m("src",e,L)}}function kt(n,t){if(n&1&&(r(0,"div",8),f(1,"img",17),r(2,"div",18),p(3,Lt,1,3,"img",19),o()()),n&2){let e=d(2);a(),m("src",e.listing.images[e.selectedImage],L)("alt",e.listing.title),a(2),m("ngForOf",e.listing.images)}}function Ot(n,t){if(n&1&&(r(0,"a",21),f(1,"i",22),l(2," Ligar"),o()),n&2){let e=d(2);m("href","tel:"+e.listing.contactPhone,L)}}function Tt(n,t){if(n&1&&(r(0,"a",23),f(1,"i",24),l(2," Enviar email"),o()),n&2){let e=d(2);m("href","mailto:"+e.listing.contactEmail,L)}}function Nt(n,t){if(n&1){let e=S();r(0,"section",1)(1,"div",4)(2,"a",5),l(3,"Voltar"),o()(),r(4,"div",6),p(5,kt,4,3,"div",7),r(6,"div",8)(7,"h2",9),l(8),o(),r(9,"div",10),l(10),o(),r(11,"div",11),l(12),j(13,"number"),o(),r(14,"p",12),l(15),o(),r(16,"div",13)(17,"button",14),u("click",function(){v(e);let s=d();return h(s.toggleFav())}),l(18),o(),p(19,Ot,3,1,"a",15)(20,Tt,3,1,"a",16),o()()()()}if(n&2){let e=d();a(2),m("routerLink",G(14,Fe)),a(3),m("ngIf",e.listing.images==null?null:e.listing.images.length),a(3),_(e.listing.title),a(2),te("",e.listing.city," - ",e.listing.state," \u2022 ",e.listing.views," visitas"),a(2),A("R$ ",ie(13,11,e.listing.price,"1.0-2")),a(3),_(e.listing.description),a(3),_(e.isFav()?"Remover dos favoritos":"Favoritar"),a(),m("ngIf",e.listing.contactPhone),a(),m("ngIf",e.listing.contactEmail)}}function Vt(n,t){n&1&&(r(0,"section",1)(1,"p",25),l(2,"An\xFAncio n\xE3o encontrado."),o(),r(3,"a",26),l(4,"Ir para a Home"),o()()),n&2&&(a(3),m("routerLink",G(1,Fe)))}var be=class n{constructor(t,e,i){this.route=t;this.router=e;this.listingService=i}listing=null;selectedImage=0;listingDetailError="";ngOnInit(){let t=this.route.snapshot.paramMap.get("id"),e=history.state&&history.state.listing;if(e&&e.id===t){this.listing=e,this.listingService.incrementViews(this.listing.id).subscribe();return}this.listingService.getById(t).subscribe({next:i=>{this.listing=i,this.listingService.incrementViews(i.id).subscribe()},error:i=>{this.listingDetailError=i?.message||"An\xFAncio n\xE3o encontrado"}})}selectImage(t){this.selectedImage=t}toggleFav(){this.listing&&this.listingService.toggleFavorite(this.listing.id)}isFav(){return this.listing?this.listingService.isFavorite(this.listing.id):!1}static \u0275fac=function(e){return new(e||n)(g(K),g(C),g(M))};static \u0275cmp=x({type:n,selectors:[["ng-component"]],standalone:!1,decls:3,vars:3,consts:[["class","container py-3",4,"ngIf"],[1,"container","py-3"],[1,"alert","alert-danger","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-outline-danger",3,"routerLink"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"row","g-4"],["class","col-lg-6",4,"ngIf"],[1,"col-lg-6"],[1,"h4","mb-2"],[1,"text-muted","mb-1"],[1,"price","h5","mb-3"],[1,"mb-3"],[1,"d-flex","gap-2","mb-3"],[1,"btn","btn-outline-danger",3,"click"],["class","btn btn-success",3,"href",4,"ngIf"],["class","btn btn-outline-primary",3,"href",4,"ngIf"],[1,"img-fluid","rounded",3,"src","alt"],[1,"d-flex","gap-2","mt-2"],["style","width:64px;height:64px;object-fit:cover;cursor:pointer;",3,"src","class","click",4,"ngFor","ngForOf"],[2,"width","64px","height","64px","object-fit","cover","cursor","pointer",3,"click","src"],[1,"btn","btn-success",3,"href"],[1,"fa","fa-phone"],[1,"btn","btn-outline-primary",3,"href"],[1,"fa","fa-envelope"],[1,"text-muted"],[1,"btn","btn-outline-primary",3,"routerLink"]],template:function(e,i){e&1&&p(0,Pt,6,3,"div",0)(1,Nt,21,15,"section",0)(2,Vt,5,2,"section",0),e&2&&(m("ngIf",i.listingDetailError),a(),m("ngIf",i.listing),a(),m("ngIf",!i.listing&&!i.listingDetailError))},dependencies:[O,I,ge,ne],styles:[".detail[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;padding:1rem}.gallery[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{width:100%;height:360px;object-fit:cover;border-radius:8px}.thumbs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.thumbs[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:cover;border:2px solid transparent;border-radius:6px;cursor:pointer}.thumbs[_ngcontent-%COMP%]   img.active[_ngcontent-%COMP%]{border-color:#09c}.price[_ngcontent-%COMP%]{color:#0c7;font-size:1.25rem;margin:.5rem 0}.meta[_ngcontent-%COMP%]{color:#666;margin-bottom:.5rem}"]})};function At(n,t){if(n&1&&(r(0,"div",9),l(1),o()),n&2){let e=d();a(),_(e.info)}}function Dt(n,t){n&1&&f(0,"input",10)}function Rt(n,t){if(n&1&&(r(0,"div",11),l(1),o()),n&2){let e=d();a(),_(e.error)}}var ye=class n{constructor(t,e,i,s){this.fb=t;this.auth=e;this.router=i;this.route=s;this.form=this.fb.group({name:[""],email:["",[y.required,y.email]],password:["",[y.required,y.minLength(6)]]});let c=this.route.snapshot.queryParamMap;this.next=c.get("next")||"/",c.get("reason")==="auth"&&(this.info="Fa\xE7a login para continuar.")}mode="login";form;error="";next="/";info="";async submit(){this.error="";try{this.mode==="register"?await this.auth.register(this.form.value.name||"",this.form.value.email,this.form.value.password):await this.auth.login(this.form.value.email,this.form.value.password),this.router.navigate([this.next])}catch(t){this.error=t?.message||"Erro"}}static \u0275fac=function(e){return new(e||n)(g(ue),g(w),g(C),g(K))};static \u0275cmp=x({type:n,selectors:[["ng-component"]],standalone:!1,decls:13,vars:7,consts:[[1,"login"],["class","alert alert-info",4,"ngIf"],[3,"ngSubmit","formGroup"],["formControlName","name","placeholder","Nome",4,"ngIf"],["formControlName","email","placeholder","Email"],["formControlName","password","type","password","placeholder","Senha"],["class","error",4,"ngIf"],["type","submit"],["type","button",1,"toggle",3,"click"],[1,"alert","alert-info"],["formControlName","name","placeholder","Nome"],[1,"error"]],template:function(e,i){e&1&&(r(0,"section",0)(1,"h2"),l(2),o(),p(3,At,2,1,"div",1),r(4,"form",2),u("ngSubmit",function(){return i.submit()}),p(5,Dt,1,0,"input",3),f(6,"input",4)(7,"input",5),p(8,Rt,2,1,"div",6),r(9,"button",7),l(10),o()(),r(11,"button",8),u("click",function(){return i.mode=i.mode==="login"?"register":"login"}),l(12),o()()),e&2&&(a(2),_(i.mode==="login"?"Entrar":"Criar conta"),a(),m("ngIf",i.info),a(),m("formGroup",i.form),a(),m("ngIf",i.mode==="register"),a(3),m("ngIf",i.error),a(2),_(i.mode==="login"?"Entrar":"Registrar"),a(2),A(" ",i.mode==="login"?"Criar uma conta":"J\xE1 tenho conta"," "))},dependencies:[I,ae,T,N,re,se,me],styles:[".login[_ngcontent-%COMP%]{max-width:420px;margin:2rem auto;display:grid;gap:.5rem}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{padding:.5rem}.error[_ngcontent-%COMP%]{color:#c00}.toggle[_ngcontent-%COMP%]{background:transparent;border:none;color:#06c;text-decoration:underline;cursor:pointer}"]})};var X=class n{constructor(t,e){this.auth=t;this.router=e}canMatch(t,e){return this.auth.currentUser$.pipe(Ue(1),Re(i=>{let s=t.data?.roles;return i?s&&!s.includes(i.role||"user")?this.router.createUrlTree(["/"]):!0:this.router.createUrlTree(["/login"])}))}static \u0275fac=function(e){return new(e||n)(k(w),k(C))};static \u0275prov=$({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ht=[{path:"",component:Z},{path:"categoria/:slug",component:Z},{path:"anunciar",component:_e,canMatch:[X]},{path:"item/:id",component:be},{path:"favoritos",component:Z,data:{favoritesOnly:!0}},{path:"login",component:ye},{path:"admin",loadChildren:()=>import("./chunk-ILX5ATWX.js").then(n=>n.AdminModule),canMatch:[X],data:{roles:["admin"]}},{path:"**",redirectTo:""}],Ce=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=ee({type:n});static \u0275inj=Y({imports:[Ie.forRoot(Ht,{useHash:!0}),Ie]})};var jt=()=>["/admin"],Ut=n=>["/categoria",n];function Bt(n,t){if(n&1){let e=S();r(0,"button",36),u("click",function(){v(e);let s=d();return h(s.goLogin())}),l(1,"Entrar"),o()}}function zt(n,t){if(n&1){let e=S();r(0,"span",37),l(1),j(2,"async"),o(),r(3,"button",38),u("click",function(s){v(e);let c=d();return c.auth.logout(),h(c.goHome(s))}),l(4,"Sair"),o()}if(n&2){let e,i=d();a(),_((e=Ee(2,1,i.auth.currentUser$))==null?null:e.name)}}function qt(n,t){if(n&1&&(r(0,"li",39)(1,"a",40),l(2),o()()),n&2){let e=t.$implicit,i=d();a(),m("routerLink",Ze(2,Ut,i.toSlug(e))),a(),_(e)}}var xe=class n{constructor(t,e,i){this.router=t;this.auth=e;this.listingService=i;this.categories=this.listingService.categories()}query="";categories=[];onSearch(){this.router.navigate(["/"],{queryParams:{q:this.query||void 0}})}goNew(){this.router.navigate(["/anunciar"])}goFav(){this.router.navigate(["/favoritos"])}goLogin(){this.router.navigate(["/login"])}goHome(t){t&&t.preventDefault(),this.router.navigateByUrl("/")}toSlug(t){return t.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}+","gu"),"").replace(/\s+/g,"-")}static \u0275fac=function(e){return new(e||n)(g(C),g(w),g(M))};static \u0275cmp=x({type:n,selectors:[["app-header"]],standalone:!1,decls:61,vars:8,consts:[["logged",""],[1,"header-wrap"],[1,"container-fluid","bg-white","border-bottom","mb-3","px-xl-5","py-2"],[1,"row","align-items-center"],[1,"col-lg-3","col-md-12"],["href","#",1,"navbar-brand","fw-bold","fs-3",3,"click"],[1,"col-lg-6","col-md-12"],[1,"input-group"],["placeholder","Buscar...",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click"],[1,"col-lg-3","col-md-12","text-end","mt-2","mt-lg-0"],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"btn","btn-outline-secondary","me-2",3,"click"],[1,"btn","btn-outline-dark","me-2",3,"routerLink"],["class","btn btn-success",3,"click",4,"ngIf","ngIfElse"],[1,"bg-light","border-top"],[1,"container","py-1"],[1,"nav","category-nav","flex-wrap"],["class","nav-item",4,"ngFor","ngForOf"],["id","headerCarousel","data-bs-ride","carousel","data-bs-interval","5000",1,"carousel","slide","mb-2"],[1,"carousel-indicators"],["type","button","data-bs-target","#headerCarousel","data-bs-slide-to","0","aria-current","true","aria-label","Slide 1",1,"active"],["type","button","data-bs-target","#headerCarousel","data-bs-slide-to","1","aria-label","Slide 2"],["type","button","data-bs-target","#headerCarousel","data-bs-slide-to","2","aria-label","Slide 3"],[1,"carousel-inner",2,"min-height","20vh"],[1,"carousel-item","active"],["src","/assets/iphone.jpg","alt","Eletr\xF4nicos",1,"d-block","w-100"],[1,"carousel-caption","d-none","d-md-block"],[1,"carousel-item"],["src","/assets/apto.jpg","alt","Im\xF3veis",1,"d-block","w-100"],["src","/assets/gol.jpg","alt","Autos",1,"d-block","w-100"],["type","button","data-bs-target","#headerCarousel","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#headerCarousel","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"btn","btn-success",3,"click"],[1,"fw-semibold","me-2"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"nav-item"],["routerLinkActive","active",1,"nav-link",3,"routerLink"]],template:function(e,i){if(e&1){let s=S();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"a",5),u("click",function(b){return v(s),h(i.goHome(b))}),l(5,"Classificados"),o()(),r(6,"div",6)(7,"div",7)(8,"input",8),H("ngModelChange",function(b){return v(s),R(i.query,b)||(i.query=b),h(b)}),o(),r(9,"button",9),u("click",function(){return v(s),h(i.onSearch())}),l(10,"Buscar"),o()()(),r(11,"div",10)(12,"button",11),u("click",function(){return v(s),h(i.goNew())}),l(13,"Anunciar"),o(),r(14,"button",12),u("click",function(){return v(s),h(i.goFav())}),l(15,"Favoritos"),o(),r(16,"a",13),l(17,"Admin"),o(),p(18,Bt,2,0,"button",14),j(19,"async"),p(20,zt,5,3,"ng-template",null,0,Je),o()()(),r(22,"div",15)(23,"div",16)(24,"ul",17),p(25,qt,3,4,"li",18),o()()(),r(26,"div",19)(27,"div",20),f(28,"button",21)(29,"button",22)(30,"button",23),o(),r(31,"div",24)(32,"div",25),f(33,"img",26),r(34,"div",27)(35,"h5"),l(36,"Encontre ofertas incr\xEDveis"),o(),r(37,"p"),l(38,"Eletr\xF4nicos, im\xF3veis, autos e mais"),o()()(),r(39,"div",28),f(40,"img",29),r(41,"div",27)(42,"h5"),l(43,"Im\xF3veis para todos os estilos"),o(),r(44,"p"),l(45,"Explore oportunidades perto de voc\xEA"),o()()(),r(46,"div",28),f(47,"img",30),r(48,"div",27)(49,"h5"),l(50,"Autos com condi\xE7\xF5es especiais"),o(),r(51,"p"),l(52,"Compre e venda com seguran\xE7a"),o()()()(),r(53,"button",31),f(54,"span",32),r(55,"span",33),l(56,"Anterior"),o()(),r(57,"button",34),f(58,"span",35),r(59,"span",33),l(60,"Pr\xF3xima"),o()()()()}if(e&2){let s=$e(21);a(8),D("ngModel",i.query),a(8),m("routerLink",G(7,jt)),a(2),m("ngIf",!Ee(19,5,i.auth.currentUser$))("ngIfElse",s),a(7),m("ngForOf",i.categories)}},dependencies:[O,I,T,N,oe,ge,pt,Xe],styles:[".header[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;padding:.75rem 1rem;border-bottom:1px solid #eee}.brand[_ngcontent-%COMP%]{font-weight:600;cursor:pointer}.search[_ngcontent-%COMP%]{flex:1;display:flex;gap:.5rem}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}input[_ngcontent-%COMP%]{width:100%;padding:.5rem}button[_ngcontent-%COMP%]{padding:.5rem .75rem}.header[_ngcontent-%COMP%]   .category-nav[_ngcontent-%COMP%]{display:flex;gap:.25rem;overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}.header[_ngcontent-%COMP%]   .category-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.25rem;border:1px solid #dee2e6;background:transparent;color:#495057}.header[_ngcontent-%COMP%]   .category-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#0d6efd;border-color:#0d6efd}.header[_ngcontent-%COMP%]   .category-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:#0d6efd;color:#fff;border-color:#0d6efd}@media (max-width: 576px){.header[_ngcontent-%COMP%]   .category-nav[_ngcontent-%COMP%]{gap:.125rem}}"]})};var Se=class n{constructor(t){this.listingService=t;this.categories=this.listingService.categories(),this.loadCategoryCounts()}title=qe("classificados-web");categories=[];categoryCounts={};async loadCategoryCounts(){for(let t of this.categories)try{let e=await P(this.listingService.search(void 0,t,void 0,!1,0,1));this.categoryCounts[t]=e.total}catch{this.categoryCounts[t]=0}}toSlug(t){return t.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}+","gu"),"").replace(/\s+/g,"-")}static \u0275fac=function(e){return new(e||n)(g(M))};static \u0275cmp=x({type:n,selectors:[["app-root"]],standalone:!1,decls:26,vars:0,consts:[[1,"mt-5","bg-dark","text-white","pt-4"],[1,"container"],[1,"row"],[1,"col-md-6","mb-3"],[1,"small"],[1,"col-md-3","mb-3"],[1,"list-unstyled","small"],[1,"border-top","border-secondary","mt-3","py-3","small","d-flex","justify-content-between"]],template:function(e,i){e&1&&(f(0,"app-header")(1,"router-outlet"),r(2,"footer",0)(3,"div",1)(4,"div",2)(5,"div",3)(6,"h5"),l(7,"Classificados"),o(),r(8,"p",4),l(9,"Compre e venda com seguran\xE7a. Encontre oportunidades em todas as categorias."),o()(),r(10,"div",5)(11,"h6"),l(12,"Categorias"),o()(),r(13,"div",5)(14,"h6"),l(15,"Contato"),o(),r(16,"ul",6)(17,"li"),l(18,"Email: suporte@classificados.com"),o(),r(19,"li"),l(20,"Telefone: (11) 99999-9999"),o()()()(),r(21,"div",7)(22,"span"),l(23,"\xA9 Classificados"),o(),r(24,"span"),l(25,"Feito com \u2764\uFE0F no Brasil"),o()()()())},dependencies:[ct,xe],encapsulation:2})};var we=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=ee({type:n,bootstrap:[Se]});static \u0275inj=Y({providers:[ze(),Qe(),{provide:it,useClass:fe,multi:!0},{provide:We,useFactory:st,multi:!0}],imports:[et,at,lt,nt,Ce]})};Ye().bootstrapModule(we,{}).catch(n=>console.error(n));
